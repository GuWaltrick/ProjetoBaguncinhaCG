<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waltrick's Tour - Sistema de Vendas</title>
    <style>
        :root {
            --verde-escuro: #025928;
            --verde-medio: #03A64A;
            --verde-claro: #8BC34A;
            --vermelho: #FF5252;
            --azul: #2196F3;
            --cinza: #666;
            --cinza-escuro: #333;
            --cinza-claro: #F5F7FA;
            --branco: #ffffff;
            --sombra: rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--cinza-claro);
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--branco);
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 6px 24px var(--sombra);
        }

        h1, h2, h3 {
            color: var(--verde-escuro);
            margin-bottom: 20px;
            text-align: center;
        }

        .logo p {
            font-style: italic;
            color: var(--cinza);
        }

        input, select, button {
            width: 100%;
            padding: 14px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus {
            border-color: var(--verde-medio);
            outline: none;
            box-shadow: 0 0 8px rgba(0, 128, 0, 0.2);
        }

        button {
            background-color: var(--verde-escuro);
            color: var(--branco);
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: var(--verde-medio);
        }

        .btn-voltar {
            background-color: var(--cinza);
        }

        .btn-voltar:hover {
            background-color: var(--cinza-escuro);
        }

        .menu a {
            display: block;
            background: var(--verde-escuro);
            color: var(--branco);
            text-decoration: none;
            padding: 14px;
            margin-bottom: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .menu a:hover {
            background: var(--verde-medio);
        }

        .card {
            background: #ffffff;
            padding: 24px;
            border-radius: 10px;
            border-left: 6px solid var(--verde-escuro);
            margin-bottom: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .assento {
            display: inline-block;
            width: 50px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            margin: 6px;
            background: var(--verde-claro);
            color: var(--branco);
            cursor: pointer;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .assento:hover {
            transform: scale(1.05);
        }

        .assento.ocupado {
            background: var(--vermelho);
            cursor: not-allowed;
        }

        .assento.selecionado {
            background: var(--azul);
        }

        .motorista {
            background: #999;
            width: 130px;
            margin: 12px auto;
            text-align: center;
            line-height: 50px;
            border-radius: 8px;
            font-weight: bold;
        }

        .resumo span {
            font-weight: bold;
            color: var(--verde-escuro);
        }

        .onibus-option {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            transition: background-color 0.2s, transform 0.2s;
        }

        .onibus-option:hover {
            background-color: #f4f4f4;
            transform: scale(1.01);
        }

        .payment-option {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .payment-option input {
            width: auto;
            margin-right: 10px;
        }

        #troco {
            background-color: #eee;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        a {
            color: var(--azul);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<!-- (Corpo HTML permanece o mesmo) -->
</body>
</html>
 <!-- Tela de Login -->
    <div id="login" class="container">
        <div class="logo">
            <h1>Waltrick's Tour</h1>
            <p>Sistema de Venda de Passagens</p>
        </div>
        
        <h2>Login</h2>
        <input type="text" placeholder="Usuário" id="usuario">
        <input type="password" placeholder="Senha" id="senha">
        <button onclick="fazerLogin()">Entrar</button>
        <p style="text-align: center; margin-top: 10px;">
            <a href="#" onclick="mostrarTela('recuperar-senha')">Esqueci minha senha</a>
        </p>
    </div>

    <!-- Tela de Recuperar Senha -->
    <div id="recuperar-senha" class="container hidden">
        <h2>Recuperar Senha</h2>
        <p>Digite seu e-mail para receber o link de recuperação:</p>
        <input type="email" placeholder="Seu e-mail cadastrado" id="email-recuperacao">
        <button onclick="recuperarSenha()">Enviar</button>
        <button class="btn-voltar" onclick="mostrarTela('login')">Voltar</button>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="container hidden">
        <div class="logo">
            <h1>Waltrick's Tour</h1>
            <p>Painel de Controle</p>
        </div>
        
        <div class="menu">
            <a href="#" onclick="mostrarTela('cadastrar-cidade')">Cadastrar Cidade</a>
            <a href="#" onclick="carregarPassageiros(); mostrarTela('visualizar-passageiros')">Ver Passageiros</a>
            <a href="#" onclick="mostrarTela('vender-passagem')">Vender Passagem</a>
            <a href="#" onclick="mostrarTela('consultar-passagens')">Consultar Passagens</a>
            <a href="#" onclick="carregarTodasPassagens(); mostrarTela('todas-passagens')">Todas as Passagens</a>
            <a href="#" onclick="mostrarTela('relatorios')">Relatórios</a>
            <a href="#" onclick="mostrarTela('login')">Sair</a>
        </div>


        
        <div class="card">
            <h3>Resumo do Dia</h3>
            <p>Passagens vendidas: <span id="total-passagens">0</span></p>
            <p>Valor total: <span id="valor-total">R$ 0,00</span></p>
        </div>
    </div>

    <!-- Vender Passagem - Selecionar Viagem -->
    <div id="vender-passagem" class="container hidden">
        <h2>Vender Passagem</h2>
        
        <div class="card">
            <h3>Selecione a Viagem</h3>
            <select id="origem">
                <option value="">Origem</option>
                <option value="cuiaba">Cuiabá</option>
                <option value="varzea-grande">Várzea Grande</option>
                <option value="rondonopolis">Rondonópolis</option>
                <option value="sinop">Sinop</option>
                <option value="tangara">Tangará da Serra</option>
            </select>
            
            <select id="destino">
                <option value="">Destino</option>
                <option value="cuiaba">Cuiabá</option>
                <option value="varzea-grande">Várzea Grande</option>
                <option value="rondonopolis">Rondonópolis</option>
                <option value="sinop">Sinop</option>
                <option value="tangara">Tangará da Serra</option>
            </select>
            
            <input type="date" id="data-viagem">
            <button onclick="buscarOnibus()">Buscar Ônibus</button>
        </div>
        
        <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
    </div>

    <!-- Tela de Cadastro de Cidades -->
<div id="cadastrar-cidade" class="container hidden">
    <h2>Cadastrar Cidade</h2>
    <input type="text" id="nova-cidade" placeholder="Nome da nova cidade">
    <button onclick="salvarCidade()">Salvar Cidade</button>
    <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
</div>


    <!-- Selecionar Ônibus -->
    <div id="selecionar-onibus" class="container hidden">
        <h2>Selecione o Ônibus</h2>
        
        <div id="opcoes-onibus">
            <!-- Opções de ônibus serão inseridas aqui pelo JavaScript -->
        </div>
        
        <button class="btn-voltar" onclick="mostrarTela('vender-passagem')">Voltar</button>
    </div>

    <!-- Selecionar Assento -->
    <div id="selecionar-assento" class="container hidden">
        <h2>Selecione o Assento</h2>
        <p style="text-align: center;" id="info-onibus-selecionado"></p>
        
        <div style="text-align: center; margin: 20px 0;">
            <div class="assento motorista">Motorista</div>
            
            <!-- Assentos serão gerados pelo JavaScript -->
            <div id="layout-assentos"></div>
        </div>
        
        <button onclick="confirmarAssento()">Confirmar Assento</button>
        <button class="btn-voltar" onclick="mostrarTela('selecionar-onibus')">Voltar</button>
    </div>

    <!-- Dados do Cliente -->
    <div id="dados-cliente" class="container hidden">
        <h2>Dados do Passageiro</h2>
        
        <input type="text" placeholder="Nome Completo" id="nome-passageiro">
        <input type="text" placeholder="CPF" id="cpf-passageiro">
        <input type="tel" placeholder="Telefone" id="telefone-passageiro">
        <input type="email" placeholder="E-mail (opcional)" id="email-passageiro">
        
        <button onclick="mostrarTela('confirmar-venda')">Continuar</button>
        <button class="btn-voltar" onclick="mostrarTela('selecionar-assento')">Voltar</button>
    </div>

    <!-- Confirmar Venda -->
    <div id="confirmar-venda" class="container hidden">
        <h2>Confirmar Venda</h2>
        
        <div class="card">
            <div class="resumo" id="resumo-venda">
                <!-- Resumo será preenchido pelo JavaScript -->
            </div>
        </div>
        
        <button onclick="mostrarTela('pagamento')">Confirmar Venda</button>
        <button class="btn-voltar" onclick="mostrarTela('dados-cliente')">Voltar</button>
    </div>

    <!-- Pagamento -->
    <div id="pagamento" class="container hidden">
        <h2>Pagamento</h2>
        <p style="text-align: center; font-size: 18px; margin-bottom: 15px;">Valor: <strong id="valor-pagamento">R$ 80,00</strong></p>
        
        <div class="card">
            <h3>Forma de Pagamento</h3>
            
            <div class="payment-option">
                <input type="radio" name="pagamento" id="dinheiro" value="Dinheiro" checked>
                <label for="dinheiro">Dinheiro</label>
            </div>
            
            <div class="payment-option">
                <input type="radio" name="pagamento" id="credito" value="Cartão de Crédito">
                <label for="credito">Cartão de Crédito</label>
            </div>
            
            <div class="payment-option">
                <input type="radio" name="pagamento" id="debito" value="Cartão de Débito">
                <label for="debito">Cartão de Débito</label>
            </div>
            
            <div class="payment-option">
                <input type="radio" name="pagamento" id="pix" value="PIX">
                <label for="pix">PIX</label>
            </div>
            
            <div id="campos-dinheiro">
                <label>Valor recebido:</label>
                <input type="number" placeholder="Digite o valor recebido" id="valor-recebido" step="0.01" oninput="calcularTroco()">
                
                <label>Troco:</label>
                <input type="text" id="troco" placeholder="R$ 0,00" disabled>
            </div>
        </div>
        
        <button onclick="finalizarVenda()">Finalizar Venda</button>
        <button class="btn-voltar" onclick="mostrarTela('confirmar-venda')">Voltar</button>
    </div>

    <!-- Passagem Emitida -->
    <div id="passagem" class="container hidden">
        <h2>Passagem Emitida</h2>
        
        <div class="card" style="text-align: center;">
            <h3>Waltrick's Tour</h3>
            <p>Passagem de Ônibus</p>
            <hr style="margin: 10px 0;">
            
            <div style="margin: 15px 0;" id="detalhes-passagem">
                <!-- Detalhes serão preenchidos pelo JavaScript -->
            </div>
            
            <div style="font-family: monospace; font-size: 24px; margin: 15px 0;" id="codigo-passagem">
                <!-- Código será gerado pelo JavaScript -->
            </div>
            
            <p>Embarque com 30 min de antecedência</p>
        </div>
        
        <button onclick="window.print()">Imprimir Passagem</button>
        <button onclick="mostrarTela('dashboard')">Voltar ao Início</button>
    </div>

    <!-- Consultar Passagens -->
    <div id="consultar-passagens" class="container hidden">
        <h2>Consultar Passagens</h2>
        
        <div class="card">
            <input type="date" id="data-consulta">
            <input type="text" placeholder="Nome do Passageiro" id="nome-consulta">
            <input type="text" placeholder="CPF (opcional)" id="cpf-consulta">
            <button onclick="buscarPassagens()">Buscar</button>
        </div>
        
        <div class="card">
            <h3>Passagens Vendidas</h3>
            <div id="lista-passagens">
                <!-- Passagens serão listadas aqui pelo JavaScript -->
            </div>
        </div>
        
        <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
    </div>

    <!-- Tela Todas as Passagens -->
<div id="todas-passagens" class="container hidden">
    <h2>Todas as Passagens</h2>
    <div class="card" id="lista-todas-passagens">
        <!-- Todas as passagens serão listadas aqui -->
    </div>
    <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
</div>


    <!-- Relatórios -->
    <div id="relatorios" class="container hidden">
        <h2>Relatórios</h2>
        
        <div class="card">
            <h3>Resumo do Dia</h3>
            <p><strong>Data:</strong> <span id="data-relatorio"></span></p>
            <p><strong>Total de passagens:</strong> <span id="total-relatorio">0</span></p>
            <p><strong>Valor total:</strong> <span id="valor-relatorio">R$ 0,00</span></p>
            <hr style="margin: 10px 0;">
            <p><strong>Dinheiro:</strong> <span id="dinheiro-relatorio">R$ 0,00 (0 passagens)</span></p>
            <p><strong>Cartão:</strong> <span id="cartao-relatorio">R$ 0,00 (0 passagens)</span></p>
            <p><strong>PIX:</strong> <span id="pix-relatorio">R$ 0,00 (0 passagens)</span></p>
        </div>
        
        <button onclick="exportarPDF()">Exportar para PDF</button>
        <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
    </div>
    <!-- Tela de Passageiros Cadastrados -->
<div id="visualizar-passageiros" class="container hidden">
    <h2>Passageiros Cadastrados</h2>
    <div class="card" id="lista-passageiros"></div>
    <button class="btn-voltar" onclick="mostrarTela('dashboard')">Voltar</button>
</div>


    <script>
        // Objeto para armazenar todos os dados da venda
        const dadosVenda = {
            origem: '',
            destino: '',
            data: '',
            horario: '',
            onibus: '',
            assento: '',
            passageiro: {
                nome: '',
                cpf: '',
                telefone: '',
                email: ''
            },
            valor: 80.00, // Valor fixo para simplificar
            formaPagamento: 'Dinheiro',
            valorRecebido: 0,
            troco: 0,
            codigo: ''
        };

        // Lista de passagens vendidas (simulando um banco de dados)
        let passagensVendidas = JSON.parse(localStorage.getItem('passagens')) || [];

        // Função para mostrar uma tela específica
        function mostrarTela(idTela) {
            // Esconde todas as telas
            document.querySelectorAll('.container').forEach(tela => {
                tela.classList.add('hidden');
            });
            
            // Mostra a tela solicitada
            document.getElementById(idTela).classList.remove('hidden');
            
            // Executa ações específicas para cada tela
            switch(idTela) {
                case 'confirmar-venda':
                    atualizarResumoVenda();
                    break;
                case 'pagamento':
                    document.getElementById('valor-pagamento').textContent = `R$ ${dadosVenda.valor.toFixed(2).replace('.', ',')}`;
                    break;
                case 'passagem':
                    gerarPassagem();
                    break;
                case 'relatorios':
                    carregarRelatorios();
                    break;
            }
        }

        // Função para recuperar senha
        function recuperarSenha() {
            const email = document.getElementById('email-recuperacao').value;
            if(email) {
                alert(`Link de recuperação enviado para: ${email}`);
                mostrarTela('login');
            } else {
                alert('Por favor, digite seu e-mail');
            }
        }

        // Função para buscar ônibus disponíveis
        function buscarOnibus() {
            const origem = document.getElementById('origem').value;
            const destino = document.getElementById('destino').value;
            const data = document.getElementById('data-viagem').value;
            
            if(!origem || !destino || !data) {
                alert('Por favor, preencha todos os campos');
                return;
            }
            
            // Armazena os dados da viagem
            dadosVenda.origem = origem;
            dadosVenda.destino = destino;
            
            // Formata a data para exibição
            const [ano, mes, dia] = data.split('-');
            dadosVenda.data = `${dia}/${mes}/${ano}`;
            
            // Simula busca de ônibus (na prática, viria de um banco de dados)
            const opcoesOnibus = [
                { horario: '08:00', assentosDisponiveis: 20, totalAssentos: 20 },
                { horario: '14:00', assentosDisponiveis: 20, totalAssentos: 20 },
                { horario: '20:00', assentosDisponiveis: 20, totalAssentos: 20 }
            ];
            
            // Exibe as opções de ônibus
            const container = document.getElementById('opcoes-onibus');
            container.innerHTML = '';
            
            opcoesOnibus.forEach((onibus, index) => {
                const div = document.createElement('div');
                div.className = 'onibus-option';
                div.innerHTML = `
                    <h3>${formatarCidade(origem)} → ${formatarCidade(destino)}</h3>
                    <p><strong>Data:</strong> ${dadosVenda.data}</p>
                    <p><strong>Horário:</strong> ${onibus.horario}</p>
                    <p><strong>Duração:</strong> 3h</p>
                    <p><strong>Assentos livres:</strong> ${onibus.assentosDisponiveis}/${onibus.totalAssentos}</p>
                    <button onclick="selecionarOnibus('${onibus.horario}', ${onibus.assentosDisponiveis})">Selecionar</button>
                `;
                container.appendChild(div);
            });
            
            mostrarTela('selecionar-onibus');
        }

        // Função para selecionar um ônibus
        function selecionarOnibus(horario, assentosDisponiveis) {
            if(assentosDisponiveis <= 0) {
                alert('Não há assentos disponíveis neste ônibus');
                return;
            }
            
            dadosVenda.horario = horario;
            
            // Atualiza a informação do ônibus selecionado
            document.getElementById('info-onibus-selecionado').textContent = 
                `Ônibus: ${formatarCidade(dadosVenda.origem)} → ${formatarCidade(dadosVenda.destino)} - ${dadosVenda.data} - ${horario}`;
            
            // Gera os assentos
            const container = document.getElementById('layout-assentos');
            container.innerHTML = '';
            
            // Assentos ocupados aleatoriamente para demonstração
            const totalAssentos = 20;
            const assentosOcupados = totalAssentos - assentosDisponiveis;
            const ocupados = new Set();
            
            while(ocupados.size < assentosOcupados) {
                ocupados.add(Math.floor(Math.random() * totalAssentos) + 1);
            }
            
            // Cria os assentos
            for(let i = 1; i <= totalAssentos; i++) {
                const assento = document.createElement('div');
                assento.className = ocupados.has(i) ? 'assento ocupado' : 'assento';
                assento.textContent = i;
                assento.onclick = function() {
                    if(!this.classList.contains('ocupado')) {
                        document.querySelectorAll('.assento').forEach(a => {
                            a.classList.remove('selecionado');
                        });
                        this.classList.add('selecionado');
                        dadosVenda.assento = i;
                    }
                };
                container.appendChild(assento);
                
                if(i % 4 === 0) {
                    container.appendChild(document.createElement('br'));
                }
            }
            
            mostrarTela('selecionar-assento');
        }

        // Função para confirmar assento selecionado
        function confirmarAssento() {
            if(!dadosVenda.assento) {
                alert('Por favor, selecione um assento');
                return;
            }
            
            mostrarTela('dados-cliente');
        }

        // Função para atualizar o resumo da venda
        function atualizarResumoVenda() {
            // Atualiza dados do passageiro
            dadosVenda.passageiro.nome = document.getElementById('nome-passageiro').value;
            dadosVenda.passageiro.cpf = document.getElementById('cpf-passageiro').value;
            dadosVenda.passageiro.telefone = document.getElementById('telefone-passageiro').value;
            dadosVenda.passageiro.email = document.getElementById('email-passageiro').value;
            
            // Valida dados obrigatórios
            if(!dadosVenda.passageiro.nome || !dadosVenda.passageiro.cpf) {
                alert('Por favor, preencha pelo menos nome e CPF do passageiro');
                mostrarTela('dados-cliente');
                return;
            }
            
            // Atualiza o resumo na tela
            const resumo = document.getElementById('resumo-venda');
            resumo.innerHTML = `
                <p><span>Origem:</span> ${formatarCidade(dadosVenda.origem)}</p>
                <p><span>Destino:</span> ${formatarCidade(dadosVenda.destino)}</p>
                <p><span>Data:</span> ${dadosVenda.data}</p>
                <p><span>Horário:</span> ${dadosVenda.horario}</p>
                <p><span>Assento:</span> ${dadosVenda.assento}</p>
                <p><span>Passageiro:</span> ${dadosVenda.passageiro.nome}</p>
                <p><span>CPF:</span> ${formatarCPF(dadosVenda.passageiro.cpf)}</p>
                <p><span>Valor:</span> R$ ${dadosVenda.valor.toFixed(2).replace('.', ',')}</p>
            `;
        }

        // Função para calcular troco
        function calcularTroco() {
            const valorRecebido = parseFloat(document.getElementById('valor-recebido').value) || 0;
            dadosVenda.valorRecebido = valorRecebido;
            dadosVenda.troco = valorRecebido - dadosVenda.valor;
            
            document.getElementById('troco').value = 
                dadosVenda.troco >= 0 ? `R$ ${dadosVenda.troco.toFixed(2).replace('.', ',')}` : 'Valor insuficiente';
        }

        // Função para finalizar a venda
        function finalizarVenda() {
            // Verifica forma de pagamento
            const formaPagamento = document.querySelector('input[name="pagamento"]:checked').value;
            dadosVenda.formaPagamento = formaPagamento;
            
            // Valida pagamento em dinheiro
            if(formaPagamento === 'Dinheiro' && dadosVenda.troco < 0) {
                alert('O valor recebido é menor que o valor da passagem');
                return;
            }
            
            // Gera código da passagem
            dadosVenda.codigo = `WLT${new Date().getTime().toString().slice(-6)}`;
            
            // Adiciona à lista de passagens vendidas
            passagensVendidas.push({...dadosVenda});
            
            // Atualiza dashboard
            atualizarDashboard();
            
            mostrarTela('passagem');
        }

        // Função para gerar a passagem
        function gerarPassagem() {
            const detalhes = document.getElementById('detalhes-passagem');
            detalhes.innerHTML = `
                <p><strong>${formatarCidade(dadosVenda.origem)}</strong> → <strong>${formatarCidade(dadosVenda.destino)}</strong></p>
                <p>${dadosVenda.data} - ${dadosVenda.horario}</p>
                <p>Assento: ${dadosVenda.assento}</p>
                <p>Passageiro: ${dadosVenda.passageiro.nome}</p>
                <p>CPF: ${formatarCPF(dadosVenda.passageiro.cpf)}</p>
                <p>Valor: R$ ${dadosVenda.valor.toFixed(2).replace('.', ',')}</p>
                <p>Pagamento: ${dadosVenda.formaPagamento}</p>
                ${dadosVenda.formaPagamento === 'Dinheiro' ? `<p>Troco: R$ ${dadosVenda.troco.toFixed(2).replace('.', ',')}</p>` : ''}
            `;
            
            document.getElementById('codigo-passagem').textContent = dadosVenda.codigo;
        }

        // Função para buscar passagens
        function buscarPassagens() {
            const data = document.getElementById('data-consulta').value;
            const nome = document.getElementById('nome-consulta').value.toLowerCase();
            const cpf = document.getElementById('cpf-consulta').value;
            
            let resultados = [...passagensVendidas];
            
            if(data) {
                const [ano, mes, dia] = data.split('-');
                const dataFormatada = `${dia}/${mes}/${ano}`;
                resultados = resultados.filter(p => p.data === dataFormatada);
            }
            
            if(nome) {
                resultados = resultados.filter(p => p.passageiro.nome.toLowerCase().includes(nome));
            }
            
            if(cpf) {
                resultados = resultados.filter(p => p.passageiro.cpf.includes(cpf));
            }
            
            const lista = document.getElementById('lista-passagens');
            lista.innerHTML = '';
            
            if(resultados.length === 0) {
                lista.innerHTML = '<p>Nenhuma passagem encontrada</p>';
                return;
            }
            
            resultados.forEach(p => {
                const div = document.createElement('div');
                div.style.marginBottom = '10px';
                div.innerHTML = `
                    <p><strong>${p.passageiro.nome}</strong> - ${formatarCidade(p.origem)} → ${formatarCidade(p.destino)} - ${p.data} - ${p.horario} - Assento ${p.assento} - R$ ${p.valor.toFixed(2).replace('.', ',')}</p>
                `;
                lista.appendChild(div);
            });
        }

        // Função para carregar relatórios
        function carregarRelatorios() {
            const hoje = new Date();
            const dia = String(hoje.getDate()).padStart(2, '0');
            const mes = String(hoje.getMonth() + 1).padStart(2, '0');
            const ano = hoje.getFullYear();
            
            document.getElementById('data-relatorio').textContent = `${dia}/${mes}/${ano}`;
            
            const passagensHoje = passagensVendidas.filter(p => {
                const [d, m, a] = p.data.split('/');
                return d === dia && m === mes && a === String(ano);
            });
            
            const total = passagensHoje.length;
            const valorTotal = passagensHoje.reduce((sum, p) => sum + p.valor, 0);
            
            const dinheiro = passagensHoje.filter(p => p.formaPagamento === 'Dinheiro');
            const cartao = passagensHoje.filter(p => p.formaPagamento.includes('Cartão'));
            const pix = passagensHoje.filter(p => p.formaPagamento === 'PIX');
            
            document.getElementById('total-relatorio').textContent = total;
            document.getElementById('valor-relatorio').textContent = `R$ ${valorTotal.toFixed(2).replace('.', ',')}`;
            document.getElementById('dinheiro-relatorio').textContent = `R$ ${dinheiro.reduce((sum, p) => sum + p.valor, 0).toFixed(2).replace('.', ',')} (${dinheiro.length} passagens)`;
            document.getElementById('cartao-relatorio').textContent = `R$ ${cartao.reduce((sum, p) => sum + p.valor, 0).toFixed(2).replace('.', ',')} (${cartao.length} passagens)`;
            document.getElementById('pix-relatorio').textContent = `R$ ${pix.reduce((sum, p) => sum + p.valor, 0).toFixed(2).replace('.', ',')} (${pix.length} passagens)`;
        }

        // Função para atualizar o dashboard
        function atualizarDashboard() {
            const hoje = new Date();
            const dia = String(hoje.getDate()).padStart(2, '0');
            const mes = String(hoje.getMonth() + 1).padStart(2, '0');
            const ano = hoje.getFullYear();
            
            const passagensHoje = passagensVendidas.filter(p => {
                const [d, m, a] = p.data.split('/');
                return d === dia && m === mes && a === String(ano);
            });
            
            document.getElementById('total-passagens').textContent = passagensHoje.length;
            document.getElementById('valor-total').textContent = 
                `R$ ${passagensHoje.reduce((sum, p) => sum + p.valor, 0).toFixed(2).replace('.', ',')}`;
        }

        // Função para exportar para PDF (simulado)
        function exportarPDF() {
            alert('Relatório exportado para PDF (simulado)');
        }

        // Função para formatar nome da cidade
        function formatarCidade(cidade) {
            const cidades = {
                'cuiaba': 'Cuiabá',
                'varzea-grande': 'Várzea Grande',
                'rondonopolis': 'Rondonópolis',
                'sinop': 'Sinop',
                'tangara': 'Tangará da Serra'
            };
            return cidades[cidade] || cidade;
        }

        // Função para formatar CPF
        function formatarCPF(cpf) {
            if(!cpf) return '';
            // Remove caracteres não numéricos
            const numeros = cpf.replace(/\D/g, '');
            // Aplica a formatação
            return numeros.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }
        function fazerLogin() {
    const usuario = document.getElementById('usuario').value.trim();
    const senha = document.getElementById('senha').value.trim();

    if (!usuario || !senha) {
        alert('Por favor, preencha o usuário e a senha.');
        return;
    }

    // Aqui poderia haver uma verificação real de credenciais
    mostrarTela('dashboard');
}


        // Mostra a tela de login ao carregar a página
        mostrarTela('login');
        // Armazena passageiros únicos no localStorage
function salvarPassageiroUnico(passageiro) {
    let passageiros = JSON.parse(localStorage.getItem('passageiros')) || [];
    const jaExiste = passageiros.some(p => p.cpf === passageiro.cpf);
    if (!jaExiste) {
        passageiros.push(passageiro);
        localStorage.setItem('passageiros', JSON.stringify(passageiros));
    }
}

// Altere a função finalizarVenda para incluir:
function finalizarVenda() {
    const formaPagamento = document.querySelector('input[name="pagamento"]:checked').value;
    dadosVenda.formaPagamento = formaPagamento;

    if (formaPagamento === 'Dinheiro' && dadosVenda.troco < 0) {
        alert('O valor recebido é menor que o valor da passagem');
        return;
    }

    dadosVenda.codigo = `WLT${new Date().getTime().toString().slice(-6)}`;
    passagensVendidas.push({ ...dadosVenda });
localStorage.setItem('passagens', JSON.stringify(passagensVendidas));


    salvarPassageiroUnico(dadosVenda.passageiro); // <-- novo

    atualizarDashboard();
    mostrarTela('passagem');
}

// Função para carregar passageiros
function carregarPassageiros() {
    const lista = document.getElementById('lista-passageiros');
    const passageiros = JSON.parse(localStorage.getItem('passageiros')) || [];
    lista.innerHTML = '';

    if (passageiros.length === 0) {
        lista.innerHTML = '<p>Nenhum passageiro cadastrado ainda.</p>';
        return;
    }

    passageiros.forEach(p => {
        lista.innerHTML += `
            <p><strong>${p.nome}</strong><br>CPF: ${formatarCPF(p.cpf)}<br>Telefone: ${p.telefone || '-'}<br>Email: ${p.email || '-'}</p><hr>
        `;
    });
}
function salvarCidade() {
    const novaCidade = document.getElementById('nova-cidade').value.trim();
    if (!novaCidade) {
        alert('Digite o nome da cidade.');
        return;
    }

    let cidades = JSON.parse(localStorage.getItem('cidades')) || [
        'Cuiabá', 'Várzea Grande', 'Rondonópolis', 'Sinop', 'Tangará da Serra'
    ];

    if (!cidades.includes(novaCidade)) {
        cidades.push(novaCidade);
        localStorage.setItem('cidades', JSON.stringify(cidades));
        alert('Cidade cadastrada com sucesso!');
    } else {
        alert('Essa cidade já está cadastrada.');
    }

    carregarCidades();
    mostrarTela('dashboard');
}

function carregarCidades() {
    const cidades = JSON.parse(localStorage.getItem('cidades')) || [
        'Cuiabá', 'Várzea Grande', 'Rondonópolis', 'Sinop', 'Tangará da Serra'
    ];

    const origem = document.getElementById('origem');
    const destino = document.getElementById('destino');

    origem.innerHTML = '<option value="">Origem</option>';
    destino.innerHTML = '<option value="">Destino</option>';

    cidades.forEach(cidade => {
        origem.innerHTML += `<option value="${cidade.toLowerCase()}">${cidade}</option>`;
        destino.innerHTML += `<option value="${cidade.toLowerCase()}">${cidade}</option>`;
    });
}
function carregarTodasPassagens() {
    const lista = document.getElementById('lista-todas-passagens');
    const passagens = JSON.parse(localStorage.getItem('passagens')) || [];

    if (passagens.length === 0) {
        lista.innerHTML = '<p>Nenhuma passagem vendida ainda.</p>';
        return;
    }

    lista.innerHTML = '';
    passagens.forEach(p => {
        lista.innerHTML += `
            <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #ccc;">
                <p><strong>${p.passageiro.nome}</strong></p>
                <p>${formatarCidade(p.origem)} → ${formatarCidade(p.destino)} - ${p.data} - ${p.horario}</p>
                <p>Assento: ${p.assento} | CPF: ${formatarCPF(p.passageiro.cpf)}</p>
                <p>Valor: R$ ${p.valor.toFixed(2).replace('.', ',')} | Pagamento: ${p.formaPagamento}</p>
            </div>
        `;
    });
}

window.onload = () => {
    carregarCidades();
    atualizarDashboard();
    mostrarTela('login');
};


    </script>
</body>
</html>